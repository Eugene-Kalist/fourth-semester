<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Рабочий график</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:Montserrat,sans-serif;background:#f0f0f0;margin:0;padding:16px}
h1{text-align:center;margin-bottom:44px;font-size:22px}
.wrapper{max-width:980px;margin:0 auto}
.top-bar{position:relative;display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.week-info{position:absolute;left:50%;transform:translateX(-50%);font-size:14px;font-weight:600;text-align:center;line-height:1.3}
.nav-btn{background:transparent;border:2px solid rgba(0,0,0,.25);border-radius:14px;padding:6px 14px;font-size:13px;cursor:pointer;transition:transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease}
.nav-btn:hover{background:rgba(255,255,255,.35);border-color:rgba(0,0,0,.35);transform:translateY(-1px);background:rgba(255,255,255,.25)}
.nav-btn:focus-visible{outline:3px solid rgba(239,83,80,.45);outline-offset:2px}
.viewport{overflow:hidden}
.month{margin-bottom:0;border:1px solid rgba(0,0,0,.08);background:#fff;border-radius:20px;padding:18px;touch-action:pan-y;width:33.333%;box-sizing:border-box}
.grid{display:flex;flex-direction:column;gap:12px;margin-bottom:0}
.cell{border:1px solid rgba(0,0,0,.08);border-radius:14px;padding:14px;min-height:90px}
.header{border-bottom:1px solid rgba(0,0,0,.15);margin-bottom:6px;padding-bottom:4px}
.day-title{font-size:16px;font-weight:700}
.date-line{font-size:13px;font-weight:600;color:#555}
.desc{margin-top:6px;font-size:15px;font-weight:600}
.fulloff{background:linear-gradient(180deg,#ededed,#f8f8f8)}
.off{background:transparent}
.work{background:linear-gradient(180deg,#d9f5e8,#f3fcf8)}
.remote{background:transparent}
.today{}
.slider{display:flex;width:300%;transform:translateX(-33.333%);transition:transform .35s ease
  align-items:flex-start;
}

/* Hover animation for day cards отключена */
.cell{transition:none;}
.cell:hover{transform:none;filter:none;}

.cell .date{color:#000 !important;}
.cell .day{color:#000 !important;}
.cell span{color:#000;}


.date-line{color:#000 !important;}

/* Работа/Учёба: единый шрифт и размер + разделители */
.desc{color:#000}
.desc .sec{padding-top:14px;margin-top:14px;border-top:1px solid rgba(0,0,0,.10)}
.desc .sec:first-child{border-top:0;margin-top:0;padding-top:0}
.sec-title{font-weight:700;letter-spacing:.02em;margin-bottom:6px;font-size:11.5px;color:#000}
.sec-text{font-size:11.5px;font-weight:600;color:#000}

.study-list{margin-top:2px}
.study-row{font-size:11.5px;line-height:1.45;padding:12px 0;border-top:1px solid rgba(0,0,0,.10);color:#000}
.study-row:first-child{border-top:0}
.study-row .pair{font-weight:700;margin-bottom:2px;color:#000}
.study-row .line2{font-weight:600;color:#000}
.study-row .room{margin-top:4px;font-weight:600;color:#000;white-space:nowrap}
.study-row .teacher{margin-top:2px;color:#000;white-space:nowrap}


.study-row .pair{font-weight:700;margin-bottom:2px;color:#000}
.study-row .line2{font-weight:600;color:#000}
.study-row .line3{margin-top:6px;color:#000;font-size:11.5px}


/* Цвета: работа / учёба / работа+учёба (градиенты) */
.study{background:linear-gradient(180deg,#e7f0ff,#f6f9ff)}
.workstudy{background:linear-gradient(180deg,#efe3ff,#faf7ff)}

/* Преподаватели (если несколько) — один под другим */
.teachers{display:inline-flex;flex-direction:column;align-items:center;vertical-align:top}
.teacher-line{display:block;white-space:nowrap;text-align:center}



.study-row .line3{display:flex;justify-content:space-between;gap:12px;margin-top:8px}
.study-row .line3 .left{text-align:left;font-weight:600}
.study-row .line3 .right{text-align:right}
.teacher-line, .teacher-one{white-space:nowrap;text-align:right}


/* Компоновка строки учёбы: 4 колонки как на скрине */
.study-row{display:grid;grid-template-columns:110px 1fr 80px 140px;column-gap:14px;align-items:center}
.study-row .c1{align-self:start}
.study-row .c1 .pair{font-weight:700;margin:0 0 6px 0}
.study-row .c1 .time{font-weight:600}
.study-row .c2{align-self:center}
.study-row .c2 .subj{font-weight:600;white-space:nowrap}
.study-row .c3{display:flex;justify-content:center;align-self:center}
.study-row .c3 .room{font-weight:600;white-space:nowrap}
.study-row .c4{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;align-self:center;padding-right:4px}
.study-row .c4 .t{white-space:nowrap;text-align:center}


/* Анимация для сегодняшнего дня */
.today{
  background-size:300% 300% !important;
  animation:todayMove 18s ease-in-out infinite;
}
@keyframes todayMove{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.today::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  background:linear-gradient(90deg, rgba(255,255,255,.0), rgba(255,255,255,.35), rgba(255,255,255,.0));
  background-size:200% 100%;
  animation:todayMove 12s linear infinite;
  pointer-events:none;
}
.cell{position:relative;overflow:hidden}


/* Мобильная адаптация: скрыть кнопки на телефоне */
@media (max-width: 720px){
  .nav-btn{display:none !important;}
  .top-bar{justify-content:center}
  .week-info{position:static;transform:none}
}
</style>
</head>
<body>

<h1>Рабочий график</h1>

<div class="wrapper">
  <div class="top-bar">
    <button class="nav-btn" id="prevBtn" onclick="slideWeek(-1)">← Предыдущая неделя</button>
    <div class="week-info" id="weekInfo"></div>
    <button class="nav-btn" id="nextBtn" onclick="slideWeek(1)">Следующая неделя →</button>
  </div>

  <div class="viewport">
    <div class="slider" id="slider"></div>
  </div>
</div>

<script>
// График 2/2: "Неделя 1" и "Неделя 2" чередуются, начиная с 02.02.2026 и далее по порядку до июня 2026.
// Рабочие дни — зелёные, выходные — серые. Другие статусы не используются.

const scheduleWeek1 = {
  1:{cls:"work",work:"09:00–12:00",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Инженерная геология",kind:"л.",room:"607/С",teacher:"Заводчикова М.Б."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Сопротивление материалов",kind:"л.",room:"520/Г",teacher:"Алейник В.И."}
  ]},
  2:{cls:"work",work:"09:00–14:00",study:[
    {pair:"4 пара",time:"15:00–16:30",subj:"Инженерная геология",kind:"лаб.",room:"206/Е",teacher:"Вержбицкая Е.Г., Вагурина А.В."},
    {pair:"5 пара",time:"16:45–18:15",subj:"Строительные материалы. Часть 2",kind:"л.",room:"401/С",teacher:"Ковалева А.Ю."}
  ]},
  3:{cls:"work",work:"09:00–12:00",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Основы водоснабжения и водоотведения",kind:"л.",room:"701/С",teacher:"Терехова Е.Л."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Средства механизации строительства",kind:"лаб.",room:"203/К",teacher:"Коломеец А.А., Литвин Р.А."}
  ]},
  4:{cls:"",study:[
    {pair:"2 пара",time:"10:45–12:15",subj:"Основы водоснабжения и водоотведения",kind:"лаб.",room:"501/Г",teacher:"Манцакова О.А., Дмитриева К.Г."},
    {pair:"3 пара",time:"12:30–14:00",subj:"Строительные материалы. Часть 2",kind:"лаб.",room:"381/Г",teacher:"Ковалева А.Ю., Хренов Г.М."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Сопротивление материалов",kind:"",room:"323/С",teacher:"Лаврентьева П.С., Алейник В.И."},
    {pair:"5 пара",time:"16:45–18:15",subj:"Экология",kind:"",room:"506/Г",teacher:"Дмитриева К.Г., Макарова С.В."}
  ]},
  5:{cls:"work",work:"09:00–12:00",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Средства механизации строительства",kind:"пр.",room:"305/К",teacher:"Мейке У.Н."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Основы теплоснабжения и вентиляции",kind:"лаб.",room:"137/Г",teacher:"Федорова И.В., Бируля В.Б."},
    {pair:"5 пара",time:"16:45–18:15",subj:"Метрология, стандартизация и сертификация",kind:"лаб.",room:"309/С",teacher:"Норин В.А., Летенко Д.Г."}
  ]},
  6:{cls:"fulloff",text:"Выходной"},
  0:{cls:"fulloff",text:"Выходной"}
};

const scheduleWeek2 = {
  1:{cls:"work",work:"09:00–12:00",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Метрология, стандартизация и сертификация",kind:"л.",room:"501/С",teacher:"Норин В.А."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Строительные материалы. Часть 2",kind:"л.",room:"407/С",teacher:"Ковалева А.Ю."},
    {pair:"5 пара",time:"16:45–18:15",subj:"Экология",kind:"л.",room:"520/Г",teacher:"Макарова С.В."}
  ]},
  2:{cls:"work",work:"10:00–19:00"},
  3:{cls:"work",work:"09:00–14:00",study:[
    {pair:"4 пара",time:"15:00–16:30",subj:"Средства механизации строительства",kind:"л.",room:"632/А",teacher:"Мейке У.Н."},
    {pair:"5 пара",time:"16:45–18:15",subj:"Основы теплоснабжения и вентиляции",kind:"пр.",room:"425/Г",teacher:"Федорова И.В."}
  ]},
  4:{cls:"",study:[
    {pair:"2 пара",time:"10:45–12:15",subj:"Основы водоснабжения и водоотведения",kind:"пр.",room:"512/Г",teacher:"Манцакова О.А."},
    {pair:"3 пара",time:"12:30–14:00",subj:"Строительные материалы. Часть 2",kind:"лаб.",room:"381/Г",teacher:"Ковалева А.Ю., Хренов Г.М."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Сопротивление материалов",kind:"",room:"323/С",teacher:"Лаврентьева П.С., Алейник В.И."}
  ]},
  5:{cls:"work",work:"09:00–12:00",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Средства механизации строительства",kind:"пр.",room:"305/К",teacher:"Мейке У.Н."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Метрология, стандартизация и сертификация",kind:"лаб.",room:"311/С",teacher:"Норин В.А., Летенко Д.Г."}
  ]},
  6:{cls:"",study:[
    {pair:"3 пара",time:"12:30–14:00",subj:"Основы теплоснабжения и вентиляции",kind:"л.",room:"401/С",teacher:"Федорова И.В."},
    {pair:"4 пара",time:"15:00–16:30",subj:"Сопротивление материалов",kind:"л.",room:"607/С",teacher:"Алейник В.И."}
  ]},
  0:{cls:"fulloff",text:"Выходной"}
};

// --- Диапазон: с февраля по июнь текущего года ---
const YEAR = 2026;
// Первый понедельник февраля
function firstMondayOfFebruary(year){
  const d = new Date(year, 1, 1); // 1 февраля
  const shift = (8 - (d.getDay() || 7)) % 7; // сколько дней до понедельника
  d.setDate(d.getDate() + shift);
  return d;
}

// Последнее воскресенье мая
function lastSundayOfMay(year){
  const d = new Date(year, 4 + 1, 0); // последний день мая (месяц 4 = май)
  const dow = d.getDay(); // 0..6 (0=вс)
  d.setDate(d.getDate() - dow); // откатываемся до воскресенья
  return d;
}

const rangeStart = new Date(2026, 1, 2); // 02.02.2026 — старт "Недели 1"
const rangeEnd = lastSundayOfMay(YEAR);

// Старт, от которого считается чередование недель ("Неделя 1" начинается в феврале)
const start = new Date(rangeStart);

// Сегодня
const today = new Date();


const holidays = new Set([
  "23.02.2026",
  "09.03.2026",
  "01.05.2026",
  "09.05.2026"
]);


// Текущая неделя: если сегодня в диапазоне — показываем её, иначе — первую неделю февраля
let currentDate = null;

let startX=0,dx=0,drag=false;
let animating=false;
const slider=document.getElementById("slider");

function getSchedule(d){
  const diff=Math.floor((d-start)/(1000*60*60*24*7));
  const week = ((diff%2+2)%2===0) ? scheduleWeek1 : scheduleWeek2;
  return week[d.getDay()];
}

function weekNumber(d){
  const onejan=new Date(d.getFullYear(),0,1);
  return Math.ceil((((d-onejan)/86400000)+onejan.getDay()+1)/7);
}

function weekIndex(monday){
  // Сквозная нумерация недель: 1-я неделя начинается 02.02.2026 и далее +1 каждую неделю
  const diffWeeks = Math.floor((monday - start) / (1000*60*60*24*7));
  return diffWeeks + 1;
}

function clampToRange(date){
  if(date < rangeStart) return new Date(rangeStart);
  if(date > rangeEnd) return new Date(rangeEnd);
  return date;
}

// Стартовая неделя при открытии: неделя, в которую попадает сегодняшняя дата (в пределах диапазона)
currentDate = clampToRange(new Date(today));

function createWeek(date,setInfo){
  const box=document.createElement("div");
  box.className="month";

  const grid=document.createElement("div");
  grid.className="grid";

  let monday=new Date(date);
  monday.setDate(date.getDate()-((date.getDay()+6)%7));
  let sunday=new Date(monday);
  sunday.setDate(monday.getDate()+6);

  if(setInfo){
  document.getElementById("weekInfo").innerHTML =
    `Неделя №${weekIndex(monday)}<br>${format(monday)} – ${format(sunday)}`;
  }

  for(let i=0;i<7;i++){
    let d=new Date(monday);
    d.setDate(monday.getDate()+i);
    grid.appendChild(cell(d));
  }

  box.appendChild(grid);
  return box;
}

// --- Слайдер: без пересборки DOM на каждое перелистывание (исключает "туда-сюда") ---
let initialized=false;

function setCenterInstant(){
  // чтобы не было "мигания/туда-сюда" на ПК: прячем на один кадр при сбросе позиции
  slider.style.transition="none";
  slider.style.visibility="hidden";
  slider.style.transform="translateX(-33.333%)";
  // форсируем layout, чтобы браузер применил transform до показа
  void slider.offsetHeight;
  requestAnimationFrame(()=>{
    slider.style.visibility="visible";
    slider.style.transition="transform .35s ease";
  });
}

function updateWeekInfoByDate(date){
  let monday=new Date(date);
  monday.setDate(date.getDate()-((date.getDay()+6)%7));
  let sunday=new Date(monday);
  sunday.setDate(monday.getDate()+6);
  document.getElementById("weekInfo").innerHTML =
    `Неделя №${weekIndex(monday)}<br>${format(monday)} – ${format(sunday)}`;
}

function initWeeks(){
  slider.innerHTML="";
  slider.append(
    createWeek(add(-7),false),
    createWeek(currentDate,false),
    createWeek(add(7),false)
  );
  updateWeekInfoByDate(currentDate);
  setCenterInstant();
  updateNavButtons();
  initialized=true;
}

function recycleWeeks(dir){
  // dir>0: ушли к следующей — удаляем первую, добавляем новую в конец
  // dir<0: ушли к предыдущей — удаляем последнюю, добавляем новую в начало
  if(dir>0){
    slider.removeChild(slider.firstElementChild);
    slider.appendChild(createWeek(add(7),false));
  } else {
    slider.removeChild(slider.lastElementChild);
    slider.insertBefore(createWeek(add(-7),false), slider.firstElementChild);
  }
  updateWeekInfoByDate(currentDate);
  setCenterInstant();
  updateNavButtons();
}

function render(){
  // совместимость: render() теперь только инициализация
  if(!initialized) initWeeks();
}

function updateNavButtons(){
  const prevBtn=document.getElementById("prevBtn");
  const nextBtn=document.getElementById("nextBtn");

  const prevDate=new Date(currentDate); prevDate.setDate(prevDate.getDate()-7);
  const nextDate=new Date(currentDate); nextDate.setDate(nextDate.getDate()+7);

  const prevAllowed = prevDate >= rangeStart;
  const nextAllowed = nextDate <= rangeEnd;

  prevBtn.disabled = !prevAllowed;
  nextBtn.disabled = !nextAllowed;

  prevBtn.style.opacity = prevAllowed ? "1" : ".45";
  nextBtn.style.opacity = nextAllowed ? "1" : ".45";
  prevBtn.style.cursor = prevAllowed ? "pointer" : "not-allowed";
  nextBtn.style.cursor = nextAllowed ? "pointer" : "not-allowed";
}

function slideWeek(dir){
  if(animating) return;

  const candidate=new Date(currentDate);
  candidate.setDate(candidate.getDate()+dir*7);

  if(candidate < rangeStart || candidate > rangeEnd) return;

  animating=true;

  slider.style.transition="transform .35s ease";
  slider.style.transform = (dir>0) ? "translateX(-66.666%)" : "translateX(0%)";

  const onEnd = (e) => {
    if(e.propertyName !== "transform") return;
    currentDate = clampToRange(candidate);
    recycleWeeks(dir);
    animating=false;
  };

  slider.addEventListener("transitionend", onEnd, {once:true});
}

function cell(d){
  let info=getSchedule(d); // let — чтобы можно было переопределять под праздники
  const el=document.createElement("div");
  el.className="cell";

  // Праздники: принудительно выходной с единым оформлением
  const dateKey = format(d);
  if(typeof holidays !== "undefined" && holidays.has(dateKey)){
    info = {cls:"fulloff", text:"Выходной"};
  }

  const hasWork = !!(info && info.work);
  const hasStudy = !!(info && info.study && info.study.length);
  const isOff = !!(info && (info.cls==="fulloff" || info.text==="Выходной"));

  if(isOff) el.classList.add("fulloff");
  else if(hasWork && hasStudy) el.classList.add("workstudy");
  else if(hasWork) el.classList.add("work");
  else if(hasStudy) el.classList.add("study");

  if(d.toDateString()===today.toDateString())el.classList.add("today");

  const sections=[];

  // helpers to compare time strings "HH:MM–HH:MM"
  function toMinutes(t){const p=t.split(":");return parseInt(p[0])*60+parseInt(p[1]);}

  let firstStudyTime = null;
  if(hasStudy){
    const starts = info.study.map(x=>{
      const s = String(x.time||"").split("–")[0];
      return s ? s.trim() : "";
    }).filter(Boolean);
    if(starts.length){
      firstStudyTime = Math.min(...starts.map(t=>toMinutes(t)));
    }
  }
  let workTime = null;
  if(hasWork){
    const t = info.work.split("–")[0];
    workTime = toMinutes(t);
  }

  const workBlock = hasWork
    ? '<div class="sec">'
        + '<div class="sec-title">РАБОТА</div>'
        + '<div class="sec-text">'+info.work+'</div>'
      + '</div>'
    : '';

  let studyBlock = '';
  if(hasStudy){
    // compute общий диапазон времени учёбы: самое раннее начало → самый поздний конец
    const mins = info.study.map(x=>{
      const parts = String(x.time||"").split("–");
      if(parts.length!==2) return null;
      return {start: toMinutes(parts[0].trim()), end: toMinutes(parts[1].trim())};
    }).filter(Boolean);
    let overall = "";
    if(mins.length){
      const startM = Math.min(...mins.map(x=>x.start));
      const endM = Math.max(...mins.map(x=>x.end));
      const pad = n => String(n).padStart(2,"0");
      const toHHMM = m => pad(Math.floor(m/60))+":"+pad(m%60);
      overall = toHHMM(startM)+"–"+toHHMM(endM);
    }
    studyBlock =
      '<div class="sec">'
        + '<div class="sec-title">УЧЁБА</div>'
        + '<div class="sec-text">'+overall+'</div>'
      + '</div>';
  }

  // order: earliest first
  if(hasWork && hasStudy){
    if(firstStudyTime !== null && workTime !== null && firstStudyTime < workTime){
      sections.push(studyBlock, workBlock);
    } else {
      sections.push(workBlock, studyBlock);
    }
  } else if(hasStudy){
    sections.push(studyBlock);
  } else if(hasWork){
    sections.push(workBlock);
  }

  if(!sections.length && info && info.text){
    sections.push('<div class="sec"><div class="sec-text">'+info.text+'</div></div>');
  }

  el.innerHTML =
    '<div class="header">'
      + '<div class="day-title">'+d.toLocaleDateString("ru",{weekday:"short"}).toUpperCase()+'</div>'
      + '<div class="date-line">'+format(d)+'</div>'
    + '</div>'
    + '<div class="desc">'+sections.join("")+'</div>';

  return el;
}

function format(d){
  return String(d.getDate()).padStart(2,"0")+"."+String(d.getMonth()+1).padStart(2,"0")+"."+d.getFullYear();
}

function add(n){
  let d=new Date(currentDate);
  d.setDate(d.getDate()+n);
  return d;
}

// Drag support
slider.addEventListener("mousedown",e=>{
  drag=true;startX=e.clientX;slider.style.transition="none";
});
window.addEventListener("mousemove",e=>{
  if(!drag)return;
  dx=e.clientX-startX;
  slider.style.transform=`translateX(calc(-33.333% + ${dx}px))`;
});
window.addEventListener("mouseup",()=>{
  if(!drag)return;
  drag=false;
  if(dx>120)slideWeek(-1);
  else if(dx<-120)slideWeek(1);
  else {
    slider.style.transition="transform .35s ease";
    slider.style.transform="translateX(-33.333%)";
  }
  dx=0;
});

// Свайп на телефоне (на ПК не влияет)
// Важно: не блокируем прокрутку вниз — preventDefault только при явном горизонтальном свайпе.
let touchActive=false;
let touchStartX=0, touchStartY=0, touchDx=0, touchDy=0;
let touchLocked=null; // null | "h" | "v"

function isMobile(){
  return window.matchMedia("(max-width: 720px)").matches;
}

slider.addEventListener("touchstart",(e)=>{
  if(!isMobile()) return;
  if(animating) return;
  if(e.touches.length!==1) return;

  touchActive=true;
  touchLocked=null;
  touchStartX=e.touches[0].clientX;
  touchStartY=e.touches[0].clientY;
  touchDx=0; touchDy=0;

  slider.style.transition="none";
},{passive:true});

slider.addEventListener("touchmove",(e)=>{
  if(!touchActive) return;
  if(!isMobile()) return;
  if(e.touches.length!==1) return;

  touchDx = e.touches[0].clientX - touchStartX;
  touchDy = e.touches[0].clientY - touchStartY;

  // выбираем направление, когда движение стало заметным
  if(touchLocked===null){
    const ax=Math.abs(touchDx), ay=Math.abs(touchDy);
    if(ax < 6 && ay < 6) return; // еще слишком мало движения
    touchLocked = (ax > ay) ? "h" : "v";
  }

  if(touchLocked==="v"){
    // вертикальная прокрутка: не вмешиваемся
    return;
  }

  // горизонтальный свайп: блокируем скролл и двигаем слайдер
  e.preventDefault();
  slider.style.transform = `translateX(calc(-33.333% + ${touchDx}px))`;
},{passive:false});

slider.addEventListener("touchend",()=>{
  if(!touchActive) return;
  touchActive=false;

  // если это был вертикальный жест — ничего не делаем
  if(touchLocked==="v"){
    touchLocked=null;
    touchDx=0; touchDy=0;
    return;
  }

  const threshold = 70;
  if(touchDx > threshold) slideWeek(-1);
  else if(touchDx < -threshold) slideWeek(1);
  else {
    slider.style.transition="transform .35s ease";
    slider.style.transform="translateX(-33.333%)";
  }

  touchLocked=null;
  touchDx=0; touchDy=0;
},{passive:true});

slider.addEventListener("touchcancel",()=>{
  if(!touchActive) return;
  touchActive=false;
  slider.style.transition="transform .35s ease";
  slider.style.transform="translateX(-33.333%)";
  touchLocked=null;
  touchDx=0; touchDy=0;
},{passive:true});

render();
</script>
</body>
</html>
